# ----------------------------
# SS configuration (.env)
# ----------------------------
# Notes:
# - SS reads config from environment variables; this file is just a template.
# - Keep secrets out of git. Only `SS_LLM_API_KEY` should be secret here.

# ----------------------------
# Core paths
# ----------------------------
SS_JOBS_DIR=./jobs
SS_QUEUE_DIR=./queue
SS_DO_TEMPLATE_LIBRARY_DIR=./assets/stata_do_library

# ----------------------------
# Job store (optional)
# ----------------------------
# Supported backends: `file` (default), `postgres`, `redis`
SS_JOB_STORE_BACKEND=file
SS_JOB_STORE_POSTGRES_DSN=
SS_JOB_STORE_REDIS_URL=

# ----------------------------
# Stata runner (optional)
# ----------------------------
# If empty, SS will try to resolve Stata from well-known paths.
# Example: SS_STATA_CMD=stata-mp -b do
SS_STATA_CMD=

# ----------------------------
# Logging
# ----------------------------
SS_LOG_LEVEL=INFO

# ----------------------------
# Tracing (optional, OpenTelemetry)
# ----------------------------
SS_TRACING_ENABLED=0
SS_TRACING_SERVICE_NAME=ss
# Supported exporters: `otlp`, `console`
SS_TRACING_EXPORTER=otlp
SS_TRACING_OTLP_ENDPOINT=http://localhost:4318/v1/traces
SS_TRACING_SAMPLE_RATIO=1.0

# ----------------------------
# LLM
# ----------------------------
# Providers: `stub` (default), `openai` (OpenAI-compatible), `yunwu` (alias of `openai`)
SS_LLM_PROVIDER=stub

# Yunwu OpenAI-compatible proxy base URLs (pick one):
# - https://yunwu.ai/v1
# - https://yunwu.zeabur.app/v1
# - https://api.apiplus.org/v1
# - https://api3.wlai.vip/v1
SS_LLM_BASE_URL=https://yunwu.ai/v1

# Secret (DO NOT COMMIT):
SS_LLM_API_KEY=

# Model id (Yunwu proxies many models via `/v1/chat/completions`).
# Per Yunwu docs, Claude examples include:
# - claude-3-5-sonnet-20240620
# - claude-sonnet-4-20250514
# Target requested by this repo setup (Claude Opus 4.5).
# Note: some proxies expose only versioned ids (e.g. `claude-opus-4-5-20251101`).
SS_LLM_MODEL=claude-opus-4-5-20251101

# Optional; empty means "provider default"
SS_LLM_TEMPERATURE=0.2
# Optional seed value (string); empty disables.
SS_LLM_SEED=

# LLM retry/timeout envelope (applies at SS layer)
SS_LLM_TIMEOUT_SECONDS=30.0
SS_LLM_MAX_ATTEMPTS=3
SS_LLM_RETRY_BACKOFF_BASE_SECONDS=1.0
SS_LLM_RETRY_BACKOFF_MAX_SECONDS=30.0

# ----------------------------
# Worker
# ----------------------------
SS_WORKER_ID=worker-local
SS_WORKER_IDLE_SLEEP_SECONDS=1.0
SS_WORKER_SHUTDOWN_GRACE_SECONDS=30.0
SS_WORKER_MAX_ATTEMPTS=3
SS_WORKER_RETRY_BACKOFF_BASE_SECONDS=1.0
SS_WORKER_RETRY_BACKOFF_MAX_SECONDS=30.0
SS_WORKER_METRICS_PORT=8001

# ----------------------------
# Upload (object store / upload-sessions)
# ----------------------------
# Supported backends: `fake` (default, for tests/dev), `s3`
SS_UPLOAD_OBJECT_STORE_BACKEND=fake

# S3-compatible settings (required when backend=s3)
SS_UPLOAD_S3_ENDPOINT=
SS_UPLOAD_S3_REGION=
SS_UPLOAD_S3_BUCKET=
SS_UPLOAD_S3_ACCESS_KEY_ID=
SS_UPLOAD_S3_SECRET_ACCESS_KEY=

# Presign + multipart envelope (v1 contract)
SS_UPLOAD_PRESIGNED_URL_TTL_SECONDS=900
SS_UPLOAD_MULTIPART_THRESHOLD_BYTES=67108864
SS_UPLOAD_MULTIPART_PART_SIZE_BYTES=8388608
SS_UPLOAD_MAX_BUNDLE_FILES=64
