<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stata Service — 智能化数据分析平台</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <style>
        /* Linear/Cursor Inspired Design System */
        :root {
            /* Light Theme (Default) */
            --bg: #ffffff;
            --surface: #ffffff;
            --surface-raised: #fafafa;
            --surface-hover: #f4f4f5;
            --border: rgba(0, 0, 0, 0.08);
            --border-strong: rgba(0, 0, 0, 0.15);
            --text: #09090b;
            --text-dim: #71717a;
            --text-muted: #a1a1aa;
            --accent: #3b82f6;
            --accent-dim: rgba(59, 130, 246, 0.05);
            --success: #10b981;
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --ease: cubic-bezier(0.16, 1, 0.3, 1);
            --transition: all 0.2s var(--ease);
        }

        [data-theme="dark"] {
            --bg: #09090b;
            --surface: #09090b;
            --surface-raised: #18181b;
            --surface-hover: #27272a;
            --border: rgba(255, 255, 255, 0.08);
            --border-strong: rgba(255, 255, 255, 0.15);
            --text: #fafafa;
            --text-dim: #a1a1aa;
            --text-muted: #71717a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            outline: none;
        }

        body {
            background: var(--bg);
            color: var(--text);
            font-family: 'Inter', -apple-system, system-ui, sans-serif;
            font-size: 14px;
            /* Increased from 13px */
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            letter-spacing: -0.012em;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        code,
        .mono {
            font-family: 'JetBrains Mono', monospace;
            letter-spacing: 0;
            font-size: 13px;
        }

        /* Layout Structure */
        .app-container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            width: 100%;
        }

        header {
            height: 64px;
            padding: 0 40px;
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            /* Pro Website Layout: Left Brand, Center Tabs, Right Actions */
            align-items: center;
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            background: var(--bg);
            z-index: 50;
            transition: background-color 0.3s ease;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            font-size: 14px;
            letter-spacing: -0.02em;
            user-select: none;
        }

        .brand-icon {
            width: 20px;
            height: 20px;
            background: var(--text);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--bg);
            font-weight: 800;
            font-size: 10px;
        }

        .tabs-container {
            display: flex;
            justify-content: center;
        }

        .tabs {
            display: flex;
            gap: 4px;
            padding: 3px;
            background: var(--surface-hover);
            border: 1px solid var(--border);
            border-radius: 8px;
        }

        .tab {
            padding: 5px 18px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            color: var(--text-dim);
            cursor: pointer;
            transition: var(--transition);
            border: none;
            background: transparent;
        }

        .tab:hover {
            color: var(--text);
        }

        .tab.active {
            background: var(--surface);
            color: var(--text);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--border);
        }

        .header-actions {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: 16px;
        }

        .theme-toggle {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            border: 1px solid var(--border);
            background: transparent;
            color: var(--text-dim);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .theme-toggle:hover {
            border-color: var(--border-strong);
            color: var(--text);
            background: var(--surface-hover);
        }

        main {
            flex: 1;
            padding: 80px 40px;
            max-width: 680px;
            margin: 0 auto;
            width: 100%;
        }

        /* Content Styling */
        h1 {
            font-size: 34px;
            font-weight: 600;
            letter-spacing: -0.04em;
            margin-bottom: 14px;
            color: var(--text);
        }

        .lead {
            font-size: 16px;
            color: var(--text-dim);
            margin-bottom: 48px;
            line-height: 1.6;
            max-width: 620px;
        }

        .required::after {
            content: " *";
            color: var(--error);
        }

        .section-label {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 12px;
            display: block;
        }

        .control-group {
            margin-bottom: 32px;
        }

        input[type="text"],
        textarea {
            width: 100%;
            background: var(--surface-raised);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            padding: 14px 18px;
            color: var(--text);
            font-family: inherit;
            font-size: 14px;
            transition: var(--transition);
        }

        input[type="text"]:focus,
        textarea:focus {
            border-color: var(--text-muted);
            background: var(--surface);
        }

        textarea {
            min-height: 160px;
            resize: none;
            line-height: 1.6;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0 18px;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            font-size: 13px;
            gap: 8px;
            height: 38px;
            border: 1px solid transparent;
        }

        .btn-primary {
            background: var(--text);
            color: var(--bg);
        }

        .btn-primary:hover {
            opacity: 0.9;
        }

        .btn-secondary {
            background: transparent;
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--surface-hover);
            border-color: var(--border-strong);
        }

        .shortcut {
            font-size: 10px;
            background: rgba(0, 0, 0, 0.05);
            padding: 1px 4px;
            border-radius: 3px;
            color: var(--text-dim);
            margin-left: 8px;
        }

        [data-theme="dark"] .shortcut {
            background: rgba(255, 255, 255, 0.1);
        }

        .drop-zone {
            border: 1px dashed var(--border);
            border-radius: var(--radius-lg);
            padding: 56px 24px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            background: var(--surface-raised);
        }

        .drop-zone:hover {
            border-color: var(--text-dim);
            background: var(--surface-hover);
        }

        .stepper {
            display: flex;
            gap: 8px;
            margin-bottom: 40px;
        }

        .step-tick {
            height: 2px;
            flex: 1;
            background: var(--border);
            border-radius: 1px;
        }

        .step-tick.active {
            background: var(--text-dim);
        }

        .step-tick.done {
            background: var(--success);
            opacity: 0.6;
        }

        .panel {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            overflow: hidden;
            margin-bottom: 24px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.01);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th {
            text-align: left;
            font-size: 12px;
            color: var(--text-muted);
            padding: 14px 18px;
            border-bottom: 1px solid var(--border);
            background: var(--surface-raised);
            font-weight: 500;
        }

        .data-table td {
            padding: 14px 18px;
            border-bottom: 1px solid var(--border);
            color: var(--text-dim);
        }

        footer {
            padding: 48px 40px;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--text-muted);
            font-size: 11px;
        }

        .hidden {
            display: none;
        }

        .view-fade {
            animation: enter 0.3s var(--ease);
        }

        @keyframes enter {
            from {
                opacity: 0;
                transform: translateY(8px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tpl-tag {
            padding: 4px 10px;
            background: var(--surface-raised);
            border: 1px solid var(--border);
            border-radius: 14px;
            font-size: 11px;
            color: var(--text-dim);
            cursor: pointer;
            transition: var(--transition);
        }

        .tpl-tag:hover {
            background: var(--surface-hover);
            color: var(--text);
        }
    </style>
</head>

<body>
    <div class="app-container">
        <header>
            <div class="brand">
                <div class="brand-icon">S</div>
                Stata Service
            </div>
            <div class="tabs-container">
                <div class="tabs">
                    <button class="tab active" data-tab="submit">分析任务</button>
                    <button class="tab" data-tab="query">执行查询</button>
                </div>
            </div>
            <div class="header-actions">
                <button class="theme-toggle" id="theme-toggle" title="切换主题">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
                    </svg>
                </button>
            </div>
        </header>

        <main>
            <!-- View: Submit -->
            <div id="view-submit" class="view-fade">
                <div class="stepper">
                    <div class="step-tick active"></div>
                    <div class="step-tick"></div>
                    <div class="step-tick"></div>
                </div>

                <h1>开启智能化分析</h1>
                <p class="lead">Stata 18 MP 分析引擎将自动为您构建全量实证模型并生成可执行脚本。完成以下必要信息即可开始。</p>

                <div class="control-group">
                    <span class="section-label required">任务验证码</span>
                    <input type="text" id="taskCode" placeholder="输入 Task Code" class="mono">
                </div>

                <div class="control-group">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                        <span class="section-label required" style="margin: 0;">研究设想与需求</span>
                        <div style="display: flex; gap: 8px;">
                            <span class="tpl-tag" onclick="applyTpl('ols')">面板回归</span>
                            <span class="tpl-tag" onclick="applyTpl('diff')">DID 模型</span>
                        </div>
                    </div>
                    <textarea id="description" placeholder="例如：分析 ESG 表现对企业价值的影响，需要控制个体与时间效应..."></textarea>
                </div>

                <div class="control-group">
                    <span class="section-label required">原始数据</span>
                    <div class="drop-zone" id="dropzone">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--text-muted)"
                            stroke-width="2" style="margin-bottom: 12px;">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                            <polyline points="17 8 12 3 7 8" />
                            <line x1="12" y1="3" x2="12" y2="15" />
                        </svg>
                        <div style="font-weight: 500; margin-bottom: 4px;">拖拽 CSV/XLSX 文件进行实时解析</div>
                        <div style="color: var(--text-muted); font-size: 11px;">支持多种编码格式，文件上限 100MB</div>
                    </div>
                    <input type="file" id="fileInput" hidden multiple>
                    <div id="fileList" style="margin-top: 16px; display: grid; gap: 8px;"></div>
                </div>

                <div style="display: flex; justify-content: flex-end; gap: 12px; margin-top: 48px;">
                    <button class="btn btn-primary" id="btn-next">继续 <span class="shortcut">⌘ ↵</span></button>
                </div>
            </div>

            <!-- Other views (simplified structure for quick delivery) -->
            <div id="view-sheets" class="view-fade hidden">
                <div class="stepper">
                    <div class="step-tick done"></div>
                    <div class="step-tick active"></div>
                    <div class="step-tick"></div>
                </div>
                <h1>选择数据源</h1>
                <p class="lead">检测到 Excel 工作簿中包含多个工作表，请确认用于实证分析的主表。</p>
                <div class="panel" id="sheet-options"></div>
                <div style="display: flex; justify-content: space-between;"><button class="btn btn-secondary"
                        onclick="showView('submit')">上一步</button><button class="btn btn-primary"
                        onclick="showView('blueprint')">确认并解析变量</button></div>
            </div>

            <div id="view-blueprint" class="view-fade hidden">
                <div class="stepper">
                    <div class="step-tick done"></div>
                    <div class="step-tick done"></div>
                    <div class="step-tick active"></div>
                </div>
                <h1>分析蓝图预检</h1>
                <p class="lead">AI 已为您识别关键变量并生成 Stata 伪代码。确认无误后即可启动计算集群。</p>
                <div class="panel">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>类型</th>
                                <th>变量名</th>
                                <th>逻辑说明</th>
                            </tr>
                        </thead>
                        <tbody class="mono">
                            <tr>
                                <td style="color:var(--accent)">DEPENDENT</td>
                                <td>roe</td>
                                <td>资产收益率</td>
                            </tr>
                            <tr>
                                <td style="color:var(--success)">INDEPENDENT</td>
                                <td>esg_score</td>
                                <td>核心解释变量</td>
                            </tr>
                            <tr>
                                <td style="color:var(--text-muted)">CONTROL</td>
                                <td>size, lev, age</td>
                                <td>企业特征控制</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="display: flex; justify-content: space-between;"><button class="btn btn-secondary"
                        onclick="showView('sheets')">重新配置</button><button class="btn btn-primary"
                        id="btn-submit-final">启动分析任务</button></div>
            </div>

            <div id="view-success" class="view-fade hidden">
                <div style="text-align: center; padding: 40px 0;">
                    <div
                        style="width: 48px; height: 48px; background: rgba(16, 185, 129, 0.1); border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; margin-bottom: 24px;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--success)"
                            stroke-width="2.5">
                            <polyline points="20 6 9 17 4 12" />
                        </svg>
                    </div>
                    <h1>任务已进入分析队列</h1>
                    <p class="lead">Stata 集群已接收您的指令。预计将在 5-15 分钟内完成解析。</p>
                    <div class="panel" style="max-width: 320px; margin: 0 auto 32px; padding: 16px; text-align: left;">
                        <span class="section-label">Job Assignment ID</span>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span class="mono" style="color:var(--accent); font-weight: 500;"
                                id="job-id-display">jb_72k9s1</span>
                            <button class="btn btn-secondary" style="height: 24px; padding: 0 8px; font-size: 10px;"
                                onclick="copyId()">Copy</button>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="location.reload()">新建分析任务</button>
                </div>
            </div>

            <div id="view-query" class="view-fade hidden">
                <h1>任务状态回溯</h1>
                <p class="lead">输入您的 Job ID 或 Task Code，实时监控分析进程或下载产出文件。</p>
                <div style="display: flex; gap: 12px; margin-bottom: 40px;">
                    <input type="text" id="queryId" placeholder="Job ID / Task Code" class="mono" style="flex: 1;">
                    <button class="btn btn-primary" onclick="handleQuery()">执行检索</button>
                </div>
                <div id="query-result" class="hidden">
                    <div class="panel" style="padding: 24px;">
                        <span class="section-label">Status Update</span>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 12px;">
                            <h3>Job Analysis (Executing)</h3><span
                                style="color:var(--accent); font-weight: 600;">75%</span>
                        </div>
                        <div style="height: 2px; background: var(--border); border-radius: 1px; margin-bottom: 32px;">
                            <div style="height: 100%; width: 75%; background: var(--accent);"></div>
                        </div>
                        <span class="section-label">Output Artifacts</span>
                        <div id="artifact-list" style="margin-top: 12px; display: grid; gap: 8px;"></div>
                    </div>
                </div>
            </div>
        </main>

        <footer>
            <div>&copy; 2026 SS Platform. All rights reserved.</div>
            <div style="display: flex; gap: 24px;"><span style="opacity: 0.5;">Stata 18 MP Edition</span><span
                    style="opacity: 0.5;">System Online</span></div>
        </footer>
    </div>

    <script>
        const state = { currentView: 'submit', jobId: null };

        // Navigation
        function showView(id) {
            document.querySelectorAll('.view-fade').forEach(v => v.classList.add('hidden'));
            document.getElementById('view-' + id).classList.remove('hidden');
            state.currentView = id; window.scrollTo(0, 0);
        }

        document.querySelectorAll('.tab').forEach(t => {
            t.onclick = () => {
                document.querySelectorAll('.tab').forEach(x => x.classList.remove('active'));
                t.classList.add('active');
                showView(t.dataset.tab);
            };
        });

        // Theme Toggle
        const themeBtn = document.getElementById('theme-toggle');
        themeBtn.onclick = () => {
            const theme = document.documentElement.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
            document.documentElement.setAttribute('data-theme', theme);
            themeBtn.innerHTML = theme === 'light'
                ? '<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>'
                : '<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="4.22" x2="19.78" y2="5.64"/></svg>';
        };

        // File Handling (Simplified)
        const dropzone = document.getElementById('dropzone');
        dropzone.onclick = () => document.getElementById('fileInput').click();
        document.getElementById('fileInput').onchange = (e) => {
            const list = document.getElementById('fileList');
            for (const f of e.target.files) {
                const item = document.createElement('div');
                item.style = "padding: 8px 12px; border: 1px solid var(--border); border-radius: 6px; display: flex; justify-content: space-between; align-items: center; font-size: 11px;";
                item.innerHTML = `<span class="mono">${f.name}</span><span style="opacity: 0.5; cursor: pointer;" onclick="this.parentElement.remove()">×</span>`;
                list.appendChild(item);
            }
        };

        // Actions
        document.getElementById('btn-next').onclick = () => {
            const btn = document.getElementById('btn-next');
            btn.innerText = '正在解析...';
            setTimeout(() => {
                btn.innerHTML = '继续 <span class="shortcut">⌘ ↵</span>';
                document.getElementById('sheet-options').innerHTML = `<div style="padding: 16px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center;"><div><b>Financial_Data</b><div style="font-size:10px; color:var(--text-muted);">1,200 rows | Main Data</div></div><div style="width:12px; height:12px; background:var(--text); border-radius:50%;"></div></div>`;
                showView('sheets');
            }, 600);
        };

        document.getElementById('btn-submit-final').onclick = () => {
            document.getElementById('btn-submit-final').innerText = '提交中...';
            setTimeout(() => {
                state.jobId = 'jb_' + Math.random().toString(36).substr(2, 6);
                document.getElementById('job-id-display').innerText = state.jobId;
                showView('success');
            }, 800);
        };

        function handleQuery() {
            const id = document.getElementById('queryId').value; if (!id) return;
            document.getElementById('query-result').classList.remove('hidden');
            document.getElementById('artifact-list').innerHTML = `<div style="padding: 12px; border: 1px solid var(--border); border-radius: 6px; display: flex; justify-content: space-between; align-items: center; background: var(--surface-raised);"><span>Final_Report.pdf</span><button class="btn btn-secondary" style="height:24px; font-size:10px;">Download</button></div>`;
        }

        function applyTpl(t) {
            const tpls = { ols: '分析 ESG 表现对企业价值的影响，需要控制个体与时间效应。', diff: '使用多时点 DID 模型分析碳交易试点政策的影响。' };
            document.getElementById('description').value = tpls[t];
        }

        function copyId() {
            navigator.clipboard.writeText(state.jobId);
            const btn = event.target; btn.innerText = 'Copied';
            setTimeout(() => btn.innerText = 'Copy', 2000);
        }
    </script>
</body>

</html>